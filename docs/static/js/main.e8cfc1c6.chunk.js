(this["webpackJsonpbujo-web"]=this["webpackJsonpbujo-web"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),c=n(7),i=n.n(c),r=(n(13),n(2)),s=n(5);n(14);function l(e,t,n,o){t.fillStyle="#edbfb7",t.fillRect(0,0,e.width,e.height),t.fillStyle="#c7e8f3";for(var a=e.width/28,c=0;c<27;c++)for(var i=0;i<40;i++)t.fillRect(a*(1+c)-1,a*(1+i)-1,3,3);"paths"in n&&n.paths.forEach((function(n){return f(e,t,n,o)}))}function f(e,t,n,o){if(n&&n.length&&o===n[0].pageIndex){var a="#2f2235",c="#2f223590",i=2*e.width/28;t.strokeStyle=c,t.lineWidth=4,t.lineJoin="round",t.beginPath(),n.forEach((function(e,n){0!==n&&(1===n&&t.moveTo(e.x*i,e.y*i),1!==n&&t.lineTo(e.x*i,e.y*i))})),t.stroke(),t.strokeStyle=a,t.lineWidth=2,t.beginPath(),n.forEach((function(e,n){0!==n&&(1===n&&t.moveTo(e.x*i,e.y*i),1!==n&&t.lineTo(e.x*i,e.y*i))})),t.stroke(),"pen"===n[0].type&&(t.fillStyle=c,n.forEach((function(e,n){0!==n&&(t.beginPath(),t.arc(e.x*i,e.y*i,2,0,2*Math.PI),t.fill())})),t.fillStyle=a,n.forEach((function(e,n){0!==n&&(t.beginPath(),t.arc(e.x*i,e.y*i,1,0,2*Math.PI),t.fill())})))}}function u(e){for(var t=0,n=!1;!n;)n=!0,e.forEach((function(e){e.index===t&&(n=!1)})),t++;return t}var d=function(e){var t=e.cellSize?2*e.cellSize:20,n=Object(a.useState)(null),c=Object(r.a)(n,2),i=c[0],u=c[1],d=Object(a.useState)(null),x=Object(r.a)(d,2),p=x[0],j=x[1],b=Object(a.useState)(!1),h=Object(r.a)(b,2),g=h[0],O=h[1],m=Object(a.useState)([]),v=Object(r.a)(m,2),k=v[0],S=v[1],y=Object(a.useState)(null),w=Object(r.a)(y,2),C=w[0],L=w[1],N=Object(a.useState)(!1),M=Object(r.a)(N,2),I=M[0],B=M[1],E=e.data,T=e.pageIndex,J=e.setCorner,P=e.updateStorage,z=e.setData,D=Object(a.useCallback)((function(e){if(null!==e){u(e),e.style.width=28*t/2+"px",e.style.height=41*t/2+"px",e.width=28*t,e.height=41*t;var n=e.getContext("2d");l(e,n,E,T)}}),[t,E,T]);Object(a.useEffect)((function(e){if(null!==i){var t={top:i.offsetTop-3,left:i.offsetLeft};J(t)}}),[J,i]),Object(a.useEffect)((function(e){if(null!==i){var t=i.getContext("2d");l(i,t,E,T)}}),[e.redraw,i,E,T]);var W=Object(a.useCallback)((function(e){return j(e)}),[]);return Object(o.jsxs)("div",{className:"text-ink shadow-2xl",onMouseLeave:function(e){O(!1),B(!1);var t=E;t.paths.push(k),z(t),P(t),S([])},onMouseMove:function(n){requestAnimationFrame((function(o){if(null!==p){if(g&&"line"===e.mode){var a=(n.clientX-i.offsetLeft)/t,c=(n.clientY-i.offsetTop)/t,r=i.getContext("2d");r.putImageData(C,0,0),f(i,r,[].concat(Object(s.a)(k),[{x:a,y:c}]),e.pageIndex)}if("pen"===e.mode&&(B(!0),p.style.top=Math.floor(n.clientY-2)+"px",p.style.left=Math.floor(n.clientX-2)+"px",g)){var l=(n.clientX-i.offsetLeft)/t,u=(n.clientY-i.offsetTop)/t;S((function(e){return[].concat(Object(s.a)(e),[{x:l,y:u}])}));var d=i.getContext("2d");f(i,d,k,e.pageIndex)}}}))},onMouseDown:function(n){if("pen"===e.mode){if(!g){O(!0);var o=(n.clientX-i.offsetLeft)/t,a=(n.clientY-i.offsetTop)/t;S([{type:"pen",pageIndex:e.pageIndex},{x:o,y:a}]);var c=i.getContext("2d");f(i,c,[{type:"pen",pageIndex:e.pageIndex},{x:o,y:a}],e.pageIndex)}}else if("eraser"===e.mode){var r=(n.clientX-i.offsetLeft)/t,s=(n.clientY-i.offsetTop)/t,u=JSON.parse(JSON.stringify(E));u.paths=[],E.paths.forEach((function(e,n){(function(e,t,n,o){var a=!1,c=null;return n.forEach((function(n,i){if(null!==c){var r=function(e,t,n,o){var a=(o-t)/(n-e);return{k:a,a:t-e*a}}(c.x,c.y,n.x,n.y),s=r.k,l=r.a,f=t-e*s;Math.abs(l-f)<4/o&&(a=!0)}Math.pow(n.x-e,2)+Math.pow(n.y-t,2)<Math.pow(4/o,2)&&(a=!0),c=n})),a})(r,s,e,t)||u.paths.push(e)})),z(u);var d=i.getContext("2d");l(i,d,u,T),P(u)}},onMouseUp:function(n){if("pen"===e.mode){if(g){O(!1);var o=E;o.paths.push(k),z(o),P(o),S([]);var a=i.getContext("2d");l(i,a,e.data,e.pageIndex)}}else if("line"===e.mode)if(g){O(!1);var c=(n.clientX-i.offsetLeft)/t,r=(n.clientY-i.offsetTop)/t,u=E;u.paths.push([].concat(Object(s.a)(k),[{x:c,y:r}])),z(u),P(u),S([]);var d=i.getContext("2d");l(i,d,e.data,e.pageIndex)}else{O(!0);var x=i.getContext("2d");L(x.getImageData(0,0,i.width,i.height));var p=(n.clientX-i.offsetLeft)/t,j=(n.clientY-i.offsetTop)/t;S([{type:"line",pageIndex:e.pageIndex},{x:p,y:j}]),f(i,x,[{type:"line",pageIndex:e.pageIndex},{x:p,y:j}],e.pageIndex)}},children:[Object(o.jsx)("canvas",{ref:D,id:"c"}),Object(o.jsx)("svg",{viewBox:"-8 -8 16 16",fill:"currentcolor",style:{display:I?"block":"none"},className:"stylus",ref:W,children:Object(o.jsx)("circle",{x:"8",y:"8",r:"4"})})]})};n(15);var x=function(e){if(!e.modeSetter||!e.mode)return Object(o.jsx)("div",{children:"info is not provided"});var t=e.setShowingBook;return Object(o.jsxs)("div",{className:"flex flex-col items-center justify-center sidebar-container text-ink",children:[Object(o.jsx)("button",{onClick:function(){t(!1)},className:"sidebar-button",children:Object(o.jsx)("svg",{viewBox:"0 0 32 32",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",children:Object(o.jsx)("path",{d:"M4 8 L28 8 M4 16 L28 16 M4 24 L28 24"})})}),Object(o.jsx)("button",{onClick:function(){"pen"===e.mode?e.modeSetter("none"):e.modeSetter("pen")},className:"sidebar-button p-1 ".concat("pen"===e.mode?"btn-selected":""),children:Object(o.jsx)("svg",{viewBox:"0 0 32 32",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",children:Object(o.jsx)("path",{d:"M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z"})})}),Object(o.jsx)("button",{onClick:function(){"line"===e.mode?e.modeSetter("none"):e.modeSetter("line")},className:"sidebar-button p-1 ".concat("line"===e.mode?"btn-selected":""),children:Object(o.jsx)("svg",{viewBox:"0 0 1000 1000",fill:"currentcolor",children:Object(o.jsx)("path",{d:"M801.2 5.5l-801.2 786.2 198.8 202.5 801.2-786.2-198.79999999999995-202.5z m61 268.7l-27.5 26.900000000000034-39.90000000000009-40.700000000000045-25.5 24.900000000000034 40 40.69999999999999-37.69999999999993 36.89999999999998-61.60000000000002-62.69999999999999-25.299999999999955 24.900000000000034 61.5 62.69999999999999-27.40000000000009 27.099999999999966-40-40.89999999999998-25.299999999999955 24.899999999999977 39.799999999999955 40.900000000000034-36.89999999999998 36.19999999999999-68.10000000000002-69.19999999999999-25.5 24.899999999999977 68.10000000000002 69.19999999999999-27.399999999999977 27.100000000000023-46.39999999999998-47.30000000000001-25.5 24.900000000000034 46.5 47.299999999999955-37.700000000000045 36.89999999999998-68.09999999999997-69.29999999999995-25.30000000000001 24.899999999999977 68 69.30000000000007-27.5 26.899999999999977-46.39999999999998-47.30000000000007-25.30000000000001 24.90000000000009 46.5 47.299999999999955-35 34.299999999999955-67.90000000000003-69.39999999999998-25.5 25 68.20000000000005 69.30000000000007-27.5 26.899999999999977-46.400000000000034-47.30000000000007-25.399999999999977 24.90000000000009 46.30000000000001 47.299999999999955-37.60000000000002 36.89999999999998-68.1-69.19999999999993-25.30000000000001 24.799999999999955 68.00000000000003 69.29999999999995-27.400000000000034 27.100000000000023-46.5-47.5-25.299999999999983 24.899999999999977 46.5 47.5-34.099999999999994 33.200000000000045-129.4-132.10000000000002 730.8000000000001-717.1999999999999 129.5 132.09999999999997-42.80000000000007 41.89999999999998-61.39999999999998-62.69999999999999-25.5 24.900000000000006 61.700000000000045 62.79999999999998z"})})}),Object(o.jsx)("button",{onClick:function(){"eraser"===e.mode?e.modeSetter("none"):e.modeSetter("eraser")},className:"sidebar-button p-1 ".concat("eraser"===e.mode?"btn-selected":""),children:Object(o.jsx)("svg",{viewBox:"0 0 1000 1000",fill:"currentcolor",children:Object(o.jsx)("path",{d:"M903.3 476.3c47.10000000000002-48.69999999999999 45-120.5-2.7999999999999545-168.3-53.5-53.599999999999994-107.10000000000002-107.19999999999999-160.60000000000002-160.7-50-50.000000000000014-123.69999999999993-50.10000000000001-173.69999999999993-0.10000000000002274-155.40000000000003 155.3-310.70000000000005 310.6-466.00000000000006 466.00000000000006-49.999999999999986 50-50.19999999999999 123.5-0.3999999999999915 173.79999999999995 29.39999999999999 29.799999999999955 58.8 59.700000000000045 89.10000000000001 88.5 6.400000000000006 6 17 10.399999999999977 25.69999999999999 10.600000000000023 43.70000000000002 1.1000000000000227 87.50000000000003 0.5 131.20000000000002 0.5 42.80000000000001 0 85.59999999999997-0.39999999999997726 128.39999999999998 0.2999999999999545 13.800000000000011 0.20000000000004547 23.80000000000001-3.8999999999999773 33.60000000000002-13.699999999999932 72.19999999999999-72.80000000000007 144.90000000000003-145.20000000000005 217.3-217.70000000000005 59.60000000000002-59.700000000000045 119.69999999999993-118.70000000000005 178.19999999999993-179.2z m-298.5 244.99999999999994l-57.69999999999993 57.700000000000045c-20.600000000000023 20.600000000000023-41 41.5-62.10000000000002 61.700000000000045-4.199999999999989 4-11.100000000000023 7.2999999999999545-16.80000000000001 7.399999999999977-81.39999999999998 0.5-162.8 0.39999999999997726-244.2 0-5.300000000000011 0-11.900000000000006-2.8999999999999773-15.699999999999989-6.600000000000023-28-27.299999999999955-55.80000000000001-54.700000000000045-82.9-82.79999999999995-33.400000000000006-34.700000000000045-33.30000000000001-83.10000000000002 0.6999999999999886-117.40000000000009 55.5-56 156.20000000000002-156.29999999999995 199.50000000000003-199.19999999999993 11.399999999999977-11.300000000000011 29.799999999999955-11.200000000000045 41.099999999999966 0.19999999999998863l238.09999999999997 238.09999999999997c11.300000000000068 11.300000000000068 11.300000000000068 29.600000000000023 0 40.89999999999998z m-3.699999999999932 143.10000000000002h336.4v25.600000000000023h-336.4v-25.600000000000023z"})})}),Object(o.jsx)("button",{onClick:function(){e.modeSetter("none"),e.setData((function(e){var t=e;return t.texts.push({top:5,left:5,text:"text"}),t})),e.setRedrawTexts((function(e){return!e}))},className:"sidebar-button p-1",children:Object(o.jsxs)("svg",{viewBox:"0 0 512 512",children:[Object(o.jsx)("rect",{x:"96",y:"48",width:"320",height:"416",rx:"48",ry:"48",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"24"}),Object(o.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24",d:"M176 128h160M176 208h160M176 288h80"})]})}),Object(o.jsx)("button",{onClick:function(){e.undoing&&e.undoing()},className:"sidebar-button flip-content",children:Object(o.jsxs)("svg",{viewBox:"0 0 512 512",children:[Object(o.jsx)("path",{d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"24"}),Object(o.jsx)("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z",fill:"currentColor"})]})}),Object(o.jsx)("button",{onClick:function(){},className:"sidebar-button p-1",children:Object(o.jsxs)("svg",{viewBox:"0 0 32 32",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",children:[Object(o.jsx)("path",{d:"M13 2 L13 6 11 7 8 4 4 8 7 11 6 13 2 13 2 19 6 19 7 21 4 24 8 28 11 25 13 26 13 30 19 30 19 26 21 25 24 28 28 24 25 21 26 19 30 19 30 13 26 13 25 11 28 8 24 4 21 7 19 6 19 2 Z"}),Object(o.jsx)("circle",{cx:"16",cy:"16",r:"4"})]})})]})};var p=function(e){var t=e.item,n=e.i,a=e.data,c=e.setData,i=e.setRedrawTexts,r=e.setCurText,s=e.font,l=e.size,f=e.corner,u=e.updateStorage,d=e.mode,x=f.left+t.left*l,p=f.top+t.top*l,j=l;return Object(o.jsx)("textarea",{className:"fixed resize bg-transparent text-ink",style:{left:x+"px",top:p+"px",minWidth:j+"px",minHeight:j+"px",fontFamily:s},onMouseUp:function(e){r(-1),i((function(e){return!e}))},onMouseDown:function(e){"eraser"===d&&(a.texts.splice(n,1),c(a),u(a),i((function(e){return!e}))),e.clientX>x+j/2||e.clientY>p+j/2||(r(n),i((function(e){return!e})))},value:t.text,onBlur:function(e){""===a.texts[n].text&&(a.texts.splice(n,1),c(a),u(a),i((function(e){return!e})))},onChange:function(e){a.texts[n].text=e.target.value,c(a),u(a),i((function(e){return!e}))}})},j=function(e){var t=document.getElementById("root"),n=e.font,c=e.setShowingBook,i=Object(a.useState)(t.offsetHeight/42),s=Object(r.a)(i,2),l=s[0],f=s[1],u=Object(a.useState)(!0),j=Object(r.a)(u,2),b=j[0],h=j[1],g=Object(a.useState)(!0),O=Object(r.a)(g,2),m=(O[0],O[1]),v=Object(a.useState)({left:0,top:0}),k=Object(r.a)(v,2),S=k[0],y=k[1],w=Object(a.useState)("none"),C=Object(r.a)(w,2),L=C[0],N=C[1],M=Object(a.useState)({paths:[],texts:[{top:0,left:0,text:"Apr 2021"}],templateLeft:"blank",templateRight:"blank"}),I=Object(r.a)(M,2),B=I[0],E=I[1],T=Object(a.useState)(-1),J=Object(r.a)(T,2),P=J[0],z=J[1];function D(){var e=B;e.paths.pop(),E(e),W(e),h((function(e){return!e}))}function W(t){!function(e,t){console.log("saving"),localStorage.setItem("page"+e,JSON.stringify(t))}(e.page,t)}return Object(a.useEffect)((function(e){t.onmousemove=function(e){-1!==P&&0!==P&&(B.texts[P].top=(e.y-S.top)/l,B.texts[P].left=(e.x-S.left)/l,E(B),W(B),m((function(e){return!e})))}}),[P,t,S,l,B]),Object(a.useEffect)((function(e){f(t.offsetHeight/42)}),[t.offsetHeight]),Object(a.useEffect)((function(e){window.addEventListener("keyup",(function(e){e.ctrlKey&&90===e.keyCode&&D()})),window.addEventListener("keydown",(function(e){if(e.ctrlKey&&90===e.keyCode)return e.preventDefault(),!1}))}),[]),Object(a.useEffect)((function(t){var n;E((n=e.page,JSON.parse(localStorage.getItem("page"+n))||{paths:[],texts:[{top:0,left:0,text:"Apr 2021"}],templateLeft:"blank",templateRight:"blank"}))}),[e.page]),Object(o.jsxs)("div",{className:"h-full",children:[Object(o.jsx)("div",{className:"flex items-center justify-center flex-row text-ink bg-back h-full w-full fixed top-0 left-0",children:Object(o.jsx)("div",{className:"pl-0.5 bg-book-shade",children:Object(o.jsxs)("div",{className:"p-1 bg-book-cover flex flex-row",children:[Object(o.jsx)("div",{className:"pl-0.5 bg-paper-shaded",children:Object(o.jsx)(d,{redraw:b,cellSize:l,data:B,pageIndex:0,setData:E,mode:L,setCorner:y,updateStorage:W})}),Object(o.jsx)("div",{className:"w-0.5"}),Object(o.jsx)(d,{redraw:b,cellSize:l,data:B,pageIndex:1,setData:E,mode:L,setCorner:function(e){return e},updateStorage:W})]})})}),Object(o.jsx)("div",{className:"flex flex-row fixed top-0 left-0 items-center h-full",children:Object(o.jsx)(x,{mode:L,modeSetter:N,setRedrawTexts:m,undoing:D,setData:E,setShowingBook:c})}),B.texts.map((function(e,t){return Object(o.jsx)(p,{font:n,item:e,size:l,i:t,data:B,setData:E,updateStorage:W,setRedrawTexts:m,setCurText:z,corner:S,mode:L},t)}))]})};n(16);var b=function(e){var t=e.setPageIndex,n=e.setShowingBook,c=e.font,i=Object(a.useState)([]),s=Object(r.a)(i,2),l=s[0],f=s[1],d=Object(a.useState)(!0),x=Object(r.a)(d,2),p=(x[0],x[1]);return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("index"));if(e)e.push({title:"new page",index:u(e)}),f(e);else{var t=[];t.push({title:"new page",index:u(t)}),f(t)}}),[]),Object(o.jsxs)("div",{style:{fontFamily:c},className:"h-screen w-screen bg-back flex items-center text-ink",children:[Object(o.jsx)("div",{}),Object(o.jsxs)("div",{className:"ml-12 mw flex flex-col h-1/2 bg-paper p-4 rounded shadow",children:[Object(o.jsx)("div",{className:"p-1 bg-paper-shaded",children:"Pages:"}),Object(o.jsx)("div",{className:"flex flex-col justify-start h-full pt-0.5 px-1 overflow-auto border border-paper-shaded rounded-sm mt-0.5 fancy-scrollbar",children:l.map((function(e,a){return Object(o.jsxs)("button",{className:"cursor-pointer rounded bg-paper-shaded p-1 mb-0.5 hover:text-ink-highlighted transition flex justify-between items-center",onClick:function(o){if(a===l.length-1){var c=l;c.pop(),c.push({title:"new page",index:u(c)}),localStorage.setItem("index",JSON.stringify(c))}t(e.index),n(!0)},children:[Object(o.jsxs)("div",{className:"flex items-center",children:[Object(o.jsx)("span",{children:" - "}),Object(o.jsx)("input",{value:e.title,name:a,className:"bg-transparent",style:{width:8*(e.title.length+1)+"px"},onChange:function(e){var t=e.target.name,n=l;n[t].title=e.target.value,f(n);var o=JSON.parse(JSON.stringify(n));o.pop(),p((function(e){return!e})),localStorage.setItem("index",JSON.stringify(o))},readOnly:a===l.length-1,onClick:function(e){e.stopPropagation()}})]}),a!==l.length-1?Object(o.jsx)("span",{onClick:function(e){if(e.stopPropagation(),a!==l.length-1){var t=l;t.splice(a,1),f(t);var n=JSON.parse(JSON.stringify(t));n.pop(),localStorage.setItem("index",JSON.stringify(n)),p((function(e){return!e}))}},children:Object(o.jsx)("svg",{viewBox:"0 0 32 32",width:"1rem",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",children:Object(o.jsx)("path",{d:"M28 6 L6 6 8 30 24 30 26 6 4 6 M16 12 L16 24 M21 12 L20 24 M11 12 L12 24 M12 6 L13 2 19 2 20 6"})})}):""]},a)}))})]})]})},h=function(){var e=Object(a.useState)(0),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),s=Object(r.a)(i,2),l=s[0],f=s[1],u="Comic Sans MS";return l?Object(o.jsx)(j,{page:n,setPageIndex:c,setShowingBook:f,font:u}):Object(o.jsx)(b,{setPageIndex:c,setShowingBook:f,font:u})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),o(e),a(e),c(e),i(e)}))};i.a.render(Object(o.jsx)(h,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),g()}],[[17,1,2]]]);
//# sourceMappingURL=main.e8cfc1c6.chunk.js.map